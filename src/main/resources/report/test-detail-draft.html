<!DOCTYPE html>
<html lang="en">
<head>
    <title>ME2E Test Results</title>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.5.0/css/all.css">
    <link rel="stylesheet" href="tree-table/jquery.treetable.css">
    <link rel="stylesheet" href="css/report-style.css">
    <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
    <script src="tree-table/jquery.treetable.js"></script>
    <script src="https://www.gstatic.com/charts/loader.js"></script>
    <style>
        .tag {
            padding: 3px 5px;
            border-radius: 8px;
            border: 2px solid #4541DD;
            font-size: 14px;
            font-weight: 600;
            color: #4541DD;
            background-color: #f7f7ff;
        }

        .container-chip input {
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            margin: 0;
        }

        .container-chip input:checked + .label {
            border-color: #4541DD;
            background-color: #4541DD;
            color: white;
            box-shadow: -5px 10px 20px 0 rgba(69, 65, 221, 0.25);
        }

        .container-chip .label {
            border-radius: 100px;
            background-color: #fff;
            border: 1px solid #b5b5b5;
            padding: 5px 10px;
            cursor: pointer;
        }

        table .label {
            font-weight: 600;
            width: 80px;
        }

        table td {
            padding: 5px 0;
        }

        .log-table {
            table-layout: fixed;
        }

        .log-table thead {
            position: sticky;
            box-shadow: 0 1px 0 0 #A6A6A6;
        }

        .log-table th {
            text-align: start;
        }

        .log-table th:first-child {
            width: 90px;
        }

        .log-table th:nth-child(2) {
            width: 110px;
        }

        .log-table td:first-child {
            width: 92px;
        }

        .log-table td:nth-child(2) {
            width: 112px;
        }

        .log-table tbody {
            display: block;
            overflow-y: auto;
            max-height: 400px;
        }

        .log-table tr {
            display: table;
            width: 100%;
        }

        .stack-trace {
            background-color: rgba(255, 95, 86, 0.05);
            border: 2px solid #FF5F56;
            margin-top: 3px;
        }

        h4 {
            background-color: rgba(129, 169, 231, 0.1);
            color: #618bde;
            padding: 5px 0;
        }

        .traces-table-container {
            overflow-x: auto;
        }

        .traces-table {
            border-collapse: collapse;
            table-layout: fixed;
            width: unset;

            & td {
                padding: 0 10px 0 0;
                vertical-align: top;
            }

            & .status {
                border-radius: 64px;
                padding: 2px 8px;
                color: white;
                font-weight: bolder;
                margin-right: 6px;
            }

            > thead > tr > th:first-child,
            > tbody > tr > td:first-child {
                position: sticky;
                left: 0;
                z-index: 2;
                background-color: white;
                min-width: 200px;
                box-shadow: inset -1px 0 0 0 #A6A6A6;
                text-align: start;
                white-space: nowrap;
            }

            > tbody > tr:first-child > td:first-child,
            > tbody > tr:first-child > td > .gantt-row > .gantt-item {
                padding-top: 12px;
            }
        }

        .gantt-row {
            display: grid;
            grid-template-columns: 50px repeat(auto-fit, 100px);
            grid-auto-flow: column;
            grid-auto-columns: 100px;
            grid-gap: 1px;
            background-color: #efefef;

            > .time-series {
                position: relative;
                left: -50px;
                text-align: center;
                font-size: 12px;
                background-color: white;
            }

            > .gantt-item {
                background-color: white;

                > details > summary {
                    list-style: none;
                }

                > details > summary::-webkit-details-marker {
                    display: none;
                }
            }

            & .gantt-bar {
                display: block;
                height: 12px;
                position: relative;
                border-radius: 12px;
                cursor: pointer;
                margin-top: 5px;
                margin-bottom: 2px;
            }

            & .duration {
                font-size: 12px;
                color: grey;
                display: flex;
                justify-content: end;
            }
        }

        .trace-details {
            background-color: white;
            border: 1pt solid #cbcbcb;
            border-radius: 4px;
            padding: 4px;
            box-shadow: 0 0 10px 0 rgba(0, 0, 0, 0.05);

            & .header {
                background-color: aliceblue;
                padding: 2px 0;
                margin-bottom: 6px;
            }
        }

        .trace-details-table {
            & .label {
                font-weight: 600;
                width: 105px;
            }

            & td {
                padding: 3px 0;
            }

            & .http-payload {
                font-size: 15px;
                white-space: pre-wrap;
            }
        }
    </style>
</head>
<body>
<div style="display: flex; justify-content: space-between; align-items: center;">
    <h1>Test Summary: Tudelu</h1>
    <a href="index-draft.html" style="color: #15134C; text-decoration: none;">
        <i class="fas fa-home fa-lg"></i>
    </a>
</div>

<div style="color: #A6A6A6; margin-bottom: 24px;">
    Source: org.jholsten.me2e
</div>

<div class="card" style="padding: 24px">
    <table class="tree-table test-overview-table" id="test-overview">
        <thead>
        <tr>
            <th class="align-left">Test</th>
            <th>Tests</th>
            <th>Failures</th>
            <th>Skipped</th>
            <th>Duration</th>
            <th>Success Rate</th>
        </tr>
        </thead>
        <tbody>
        <tr data-tt-id="1">
            <td class="align-left success"><a style="color: #0BBD58;" href="test-detail-draft.html#1">Parent</a></td>
        </tr>
        <tr data-tt-id="2" data-tt-parent-id=null>
            <td class="align-left success">Child</td>
        </tr>
        <tr data-tt-id="4" data-tt-parent-id="2">
            <td class="align-left success">Child</td>
        </tr>
        <tr data-tt-id="3">
            <td class="align-left success">Parent</td>
        </tr>
        </tbody>
    </table>
</div>

<h2>Resource Usage</h2>
<p>
    The following diagrams show the resource usage of the Docker containers during the execution
    of the tests belonging to "Tudelu".
</p>
<div class="card">
    <div>
        Select the container for which you want to display the resource usage.
    </div>
    <div class="container-chip-group" style="padding: 16px 0 48px 0;">
        <span class="container-chip">
            <label for="database">
                <input type="radio" id="database"
                       value="database" name="container-chip-group"
                       onclick="onContainerSelected('database')"
                       checked>
                <span class="label">database</span>
            </label>
        </span>
        <span class="container-chip">
            <label for="backend-api">
                <input type="radio" id="backend-api"
                       value="backend-api" name="container-chip-group"
                       onclick="onContainerSelected('backend-api')">
                <span class="label">backend-api</span>
            </label>
        </span>
        <span class="container-chip">
            <label for="auth-server">
                <input type="radio" id="auth-server"
                       value="auth-server" name="container-chip-group"
                       onclick="onContainerSelected('auth-server')">
                <span class="label">auth-server</span>
            </label>
        </span>
    </div>
    <div style="text-align: center; margin-bottom: 12px;">
        <b id="resource-usage-chart-title">Resource Usage of Container "database"</b>
    </div>
    <div style="height: 300px;">
        <div id="chart_div"></div>
    </div>
</div>

<h2>Test Results</h2>
<h3><i class="fas fa-ban skipped"></i> Tudelu > skippi</h3>
<div class="card">
    <table>
        <tr>
            <td class="label">Tags:</td>
            <td><span class="tag">Tag1</span> <span class="tag">Tag2</span></td>
        </tr>
        <tr>
            <td class="label">Status:</td>
            <td class="skipped"><i class="fas fa-ban"></i> <b>Skipped</b></td>
        </tr>
        <tr>
            <td class="label">Reason:</td>
            <td>
                Didn't want to execute this thing because it is too stupid for my taste and even if I would, then I did not want to do it,
                because it is what it is.
            </td>
        </tr>
    </table>
</div>

<div style="padding: 16px 0;"></div>

<h3 id="1"><i class="fas fa-circle-check success"></i> Tudelu > abc</h3>
<div class="card">
    <table>
        <tr>
            <td class="label">Tags:</td>
            <td><span class="tag">Tag1</span> <span class="tag">Tag2</span></td>
        </tr>
        <tr>
            <td class="label">Status:</td>
            <td class="success"><i class="fas fa-circle-check"></i> <b>Success</b></td>
        </tr>
        <tr>
            <td class="label">Started:</td>
            <td>12:08.328</td>
        </tr>
        <tr>
            <td class="label">Finished:</td>
            <td>12:09.328</td>
        </tr>
        <tr>
            <td class="label">Duration:</td>
            <td>0.783s</td>
        </tr>
        <tr>
            <td class="label">Report Entries:</td>
            <td>
                <ul>
                    <li>Key: Value</li>
                    <li>Key2: Value2</li>
                </ul>
            </td>
        </tr>
    </table>

    <hr class="divider">

    <h4>Network Traces</h4>
    <div class="traces-table-container">
        <table class="traces-table" id="traces">
            <thead>
            <tr>
                <th>Request</th>
                <th>
                    <div class="gantt-row" style="background-color: white">
                        <div></div>
                        <div class="time-series">18:00:35.000</div>
                        <div class="time-series">18:00:35.100</div>
                        <div class="time-series">18:00:35.200</div>
                        <div class="time-series">18:00:35.300</div>
                        <div class="time-series">18:00:35.400</div>
                        <div class="time-series">18:00:35.500</div>
                        <div class="time-series">18:00:35.600</div>
                        <div class="time-series">18:00:35.700</div>
                        <div class="time-series">18:00:35.800</div>
                    </div>
                </th>
            </tr>
            </thead>
            <tbody>
            <tr data-tt-id="1" data-tt-parent-id=null>
                <td><span class="status" style="background-color: #0BBD58;">200</span> <span class="inline-code">GET /data HTTP/1.1</span>
                </td>
                <td>
                    <div class="gantt-row">
                        <div style="background-color: white;"></div>
                        <div class="gantt-item">
                            <details style="left: 25px; position: relative; width: 500px" open>
                                <summary>
                                <span style="width: 300px; display: block">
                                    <span class="gantt-bar" style="background-color: #4541DD;"></span>
                                    <span class="duration">82ms</span>
                                </span>
                                </summary>
                                <div class="trace-details">
                                    <div class="header">
                                        <b>Request:</b> <span class="inline-code">POST /data HTTP/1.1</span>
                                    </div>
                                    <table class="trace-details-table">
                                        <tr>
                                            <td class="label">Frame-No.:</td>
                                            <td>1</td>
                                        </tr>
                                        <tr>
                                            <td class="label">Timestamp:</td>
                                            <td>30.01.2024 12:02:01.12345</td>
                                        </tr>
                                        <tr>
                                            <td class="label">Source:</td>
                                            <td>
                                                <i class="fas fa-square" style="font-size: 14px; color: #4541DD; vertical-align: 1px;"></i>
                                                Network Gateway <i class="break-word">a_longer_network_name_with_probably_does_not_fit_into_one_line</i>
                                                (<span
                                                    class="inline-code">127.0.0.1:80</span>)
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="label">Destination:</td>
                                            <td>
                                                <i class="fas fa-square"
                                                   style="font-size: 14px; color: aquamarine; vertical-align: 1px;"></i>
                                                Mock Server <i>payment.example.com</i>
                                                (<span class="inline-code">192.168.65.2:1080</span>)
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="label">Headers:</td>
                                            <td class="inline-code break-word">
                                                <div>
                                                    <b>Host:</b>
                                                    <span>payment.example.com</span>
                                                </div>
                                                <div>
                                                    <b>Content-Type:</b>
                                                    <span>application/json</span>
                                                </div>
                                                <div>
                                                    <b>Anything:</b>
                                                    <span>Asuperlongvaluethatmayormaynotfitintoonelineandlet'sseehowthisislooking.</span>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="label">Payload:</td>
                                            <td>
<pre class="http-payload break-word" style="margin: 0">{
    "emobId": 123,
    "sessionId": 1,
    "Asuperlongvaluethatmayormaynotfitintoonelineandlet": 2
}</pre>
                                            </td>
                                        </tr>
                                    </table>
                                    <div class="header" style="margin-top: 12px;">
                                        <b>Response:</b> <span class="inline-code">HTTP/1.1 200 OK</span>
                                    </div>
                                    <div>
                                        TODO: Response Data
                                    </div>
                                </div>
                            </details>
                        </div>
                        <div class="gantt-item"></div>
                        <div class="gantt-item"></div>
                        <div class="gantt-item"></div>
                        <div class="gantt-item"></div>
                        <div class="gantt-item"></div>
                        <div class="gantt-item"></div>
                        <div class="gantt-item"></div>
                        <div class="gantt-item"></div>
                    </div>
                </td>
            </tr>
            <tr data-tt-id="2" data-tt-parent-id=1>
                <td><span class="status" style="background-color: #ffb91a;">401</span> <code class="inline-code">POST /search?query=1
                    HTTP/1.1</code></td>
                <td>
                    <div class="gantt-row">
                        <div style="background-color: white;"></div>
                        <div class="gantt-item">
                            <details style="left: 40px; position: relative; width: 500px">
                                <summary>
                    <span style="width: 150px; display: block">
                        <span class="gantt-bar" style="background-color: aquamarine;"></span>
                        <span class="duration">61ms</span>
                    </span>
                                </summary>
                                <div class="trace-details">
                                    TODO: Add Request and Response Data
                                </div>
                            </details>
                        </div>
                        <div class="gantt-item"></div>
                        <div class="gantt-item"></div>
                        <div class="gantt-item"></div>
                        <div class="gantt-item"></div>
                        <div class="gantt-item"></div>
                        <div class="gantt-item"></div>
                        <div class="gantt-item"></div>
                        <div class="gantt-item"></div>
                    </div>
                </td>
            </tr>
            <tr data-tt-id="3" data-tt-parent-id=1>
                <td><span class="status" style="background-color: #FF5F56;">500</span> <code class="inline-code">POST /search?query=1
                    HTTP/1.1</code></td>
                <td>
                    <div class="gantt-row">
                        <div style="background-color: white;"></div>
                        <div class="gantt-item">
                            <details style="left: 40px; position: relative; width: 500px">
                                <summary>
                                <span style="width: 15px; display: block">
                                    <span class="gantt-bar" style="background-color: aquamarine;"></span>
                                    <span class="duration">61ms</span>
                                </span>
                                </summary>
                                <div class="trace-details">
                                    TODO: Add Request and Response Data
                                </div>
                            </details>
                        </div>
                        <div class="gantt-item"></div>
                        <div class="gantt-item"></div>
                        <div class="gantt-item"></div>
                        <div class="gantt-item"></div>
                        <div class="gantt-item"></div>
                        <div class="gantt-item"></div>
                        <div class="gantt-item"></div>
                        <div class="gantt-item"></div>
                    </div>
                </td>
            </tr>
            </tbody>
        </table>
    </div>

    <h4>Logs</h4>
    <table class="log-table">
        <thead>
        <tr>
            <th>Time</th>
            <th>Service</th>
            <th>Message</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td><code>12:03.235</code></td>
            <td><code>Test Runner</code></td>
            <td><code>Hello from the Test Runner</code></td>
        </tr>
        <tr>
            <td><code>12:03.235</code></td>
            <td><code>Test Runner</code></td>
            <td><code>Hello from the Test Runner</code></td>
        </tr>
        <tr>
            <td><code>12:03.235</code></td>
            <td><code>Test Runner</code></td>
            <td><code>Hello from the Test Runner</code></td>
        </tr>
        <tr>
            <td><code>12:03.235</code></td>
            <td><code>Test Runner</code></td>
            <td><code>Hello from the Test Runner</code></td>
        </tr>
        </tbody>
    </table>
</div>

<script type="text/javascript">
    $(document).ready(function () {
        $("#traces").treetable({
            expandable: true,
            initialState: "expanded",
            indent: 20,
        });
    });
</script>

<div style="padding: 16px 0;"></div>

<h3 id="2"><i class="fas fa-circle-xmark failure"></i> Tudelu > fail</h3>
<div class="card">
    <table>
        <tr>
            <td class="label">Tags:</td>
            <td><span class="tag">Tag1</span> <span class="tag">Tag2</span> <span class="tag">Tag3</span></td>
        </tr>
        <tr>
            <td class="label">Status:</td>
            <td class="failure"><i class="fas fa-circle-xmark"></i> <b>Failed</b></td>
        </tr>
        <tr>
            <td class="label">Duration:</td>
            <td>0.783s</td>
        </tr>
        <tr>
            <td class="label">Report Entries:</td>
            <td>
                <ul>
                    <li>Key: Value</li>
                    <li>Key2: Value2</li>
                </ul>
            </td>
        </tr>
    </table>

    <div style="margin-top: 12px;">
        <b>Failure:</b>
    </div>
    <div>
        <pre class="stack-trace">
java.lang.RuntimeException: NONONO
	at org.jholsten.me2e.ztest.Tudelu.bla(Tudelu.kt:74)
	at java.base/java.lang.reflect.Method.invoke(Method.java:567)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)</pre>
    </div>

    <hr class="divider">

    <h4>Network Traces</h4>
    <p>
        TODO: Traces
    </p>

    <hr class="divider">

    <h4>Logs</h4>
    <table class="log-table">
        <thead>
        <tr>
            <th>Time</th>
            <th>Service</th>
            <th>Message</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td>12:03.235</td>
            <td>Test Runner</td>
            <td>Hello from the Test Runner</td>
        </tr>
        <tr>
            <td>12:03.235</td>
            <td>Test Runner</td>
            <td>Hello from the Test Runner</td>
        </tr>
        <tr>
            <td>12:03.235</td>
            <td>Backend-API</td>
            <td>This is a longer message which does not fit into one line, therefore we need to wrap it to multiple lines. Let's see how
                this is looking.
            </td>
        </tr>
        <tr>
            <td>12:03.235</td>
            <td>Backend-API</td>
            <td>This is a longer message which does not fit into one line, therefore we need to wrap it to multiple lines. Let's see how
                this is looking.
            </td>
        </tr>
        </tbody>
    </table>
</div>

<div style="margin-bottom: 1000px;">
    eyo
</div>

<div id="footer">
    <span>Generated by <a href="https://gitlab.informatik.uni-bremen.de/master-thesis1/me2e">ME2E</a> at 21.01.2024, 17:23:40</span>
</div>

<script type="text/javascript">
    selectedContainer = "database";

    google.charts.load('current', {'packages': ['line']});
    google.charts.setOnLoadCallback(drawChart);

    function onContainerSelected(containerName) {
        this.selectedContainer = containerName;
        console.log(this.selectedContainer);
    }

    function drawChart() {
        const data = google.visualization.arrayToDataTable([
            ['Time', 'Memory Usage', 'CPU Usage', 'Network IN', 'Network OUT'],
            ['08:21:01', null, 0.13, 6000, 2000],
            ['08:21:02', 0.13, 0.15, 6500, 2200],
            ['08:21:03', 0.22, 0.08, 6900, 2500],
            ['08:21:04', 0.30, 0.07, 7300, 2500],
            ['08:21:05', 0.23, 0.06, 7300, 2900],
            ['08:21:06', 0.20, 0.05, 7600, 2950]
        ]);

        const options = {
            height: 300,
            series: {
                0: {axis: 'Percent'},
                1: {axis: 'Percent'},
                2: {axis: 'Bytes'},
                3: {axis: 'Bytes'}
            },
            axes: {
                y: {
                    Percent: {label: 'Percentage [%]'},
                    Bytes: {label: 'Number of Bytes [B]'}
                }
            },
            selectionMode: 'multiple',
            animation: {
                startup: true,
            },
        };

        const chart = new google.charts.Line(document.getElementById('chart_div'));
        chart.draw(data, google.charts.Line.convertOptions(options));
    }
</script>

<script type="text/javascript">
    $(document).ready(function () {
        $("#test-overview").treetable({
            expandable: true,
            initialState: "expanded",
            indent: 20,
        });
    });
</script>
</body>
</html>
